import{_ as e,c as a,o as s,a8 as i}from"./chunks/framework.D7NPx0id.js";const m=JSON.parse('{"title":"Installation","description":"","frontmatter":{},"headers":[],"relativePath":"guide/deployment/node-installation.md","filePath":"guide/deployment/node-installation.md"}'),t={name:"guide/deployment/node-installation.md"},n=i(`<h1 id="installation" tabindex="-1">Installation <a class="header-anchor" href="#installation" aria-label="Permalink to &quot;Installation&quot;">​</a></h1><div class="info custom-block"><p class="custom-block-title">INFO</p><p>This section will provide installation instructions for installing a node.<br><br><strong>These instructions assume that the <a href="./node-registration.html#creating-a-node-in-the-hub">node has been registered in the UI</a> and that you have obtained the <a href="./node-registration.html#credentials-for-deployment">credentials for your node&#39;s robot</a>.</strong></p></div><h2 id="requirements" tabindex="-1">Requirements <a class="header-anchor" href="#requirements" aria-label="Permalink to &quot;Requirements&quot;">​</a></h2><h3 id="hardware" tabindex="-1">Hardware <a class="header-anchor" href="#hardware" aria-label="Permalink to &quot;Hardware&quot;">​</a></h3><ul><li>8 cores</li><li>16GB (minimum) - 32GB (recommended) RAM</li><li>100GB storage</li></ul><h3 id="networking" tabindex="-1">Networking <a class="header-anchor" href="#networking" aria-label="Permalink to &quot;Networking&quot;">​</a></h3><ul><li>Ports 22 and 443 are open</li><li>Access to the internet for communicating with the Hub</li></ul><h3 id="software" tabindex="-1">Software <a class="header-anchor" href="#software" aria-label="Permalink to &quot;Software&quot;">​</a></h3><h4 id="kubernetes" tabindex="-1">Kubernetes <a class="header-anchor" href="#kubernetes" aria-label="Permalink to &quot;Kubernetes&quot;">​</a></h4><p>Kubernetes (also known as k8s) is a container management software package which allows for rapid deployment and scaling of multiple applications and service. There are multiple distributions of k8s available for a variety of system configurations. The only requirement for the FLAME Node software is that a network plugin (e.g. Calico) is installed in your k8s installation to allow for network policy management. The following distributions have been tested for use with the Node software:</p><ul><li><a href="https://kubernetes.io/docs/setup/" target="_blank" rel="noreferrer">Kubernetes</a></li><li><a href="https://minikube.sigs.k8s.io/docs/start/?arch=%2Fwindows%2Fx86-64%2Fstable%2F.exe+download" target="_blank" rel="noreferrer">minikube</a></li><li><a href="https://microk8s.io/docs/getting-started" target="_blank" rel="noreferrer">microk8s</a></li></ul><h4 id="helm" tabindex="-1">Helm <a class="header-anchor" href="#helm" aria-label="Permalink to &quot;Helm&quot;">​</a></h4><p>The FLAME Node software package is a compilation of multiple services working together and require several configuration parameters to be properly set during installation. <a href="https://helm.sh/" target="_blank" rel="noreferrer">Helm</a> is k8s application management tool that simplifies deploying complex software. It enables one to easily install, update, or rollback multi-service software and we highly recommend using this tool for installing the FLAME Node. <a href="https://helm.sh/docs/intro/install/" target="_blank" rel="noreferrer">See the Helm website</a> for instructions on how to install Helm on your system.</p><h2 id="preparation" tabindex="-1">Preparation <a class="header-anchor" href="#preparation" aria-label="Permalink to &quot;Preparation&quot;">​</a></h2><p>In order to deploy a node, you will need the following pieces of information for your node&#39;s robot from the Hub:</p><ol><li>ID</li><li>Secret (not hashed!)</li></ol><p>With this information, you can either edit the <code>values.yaml</code> file included with the FLAME Node helm chart or create you own values template file to be applied to the installation and upgrades of the node such that it looks like this:</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">global</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  hub</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    endpoints</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      ...</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    auth</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      robotUser</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&lt;Robot ID&gt;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      robotSecret</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&lt;Robot Secret&gt;</span></span></code></pre></div><h3 id="keycloak" tabindex="-1">Keycloak <a class="header-anchor" href="#keycloak" aria-label="Permalink to &quot;Keycloak&quot;">​</a></h3><p>By default, the FLAME Node package deploys keycloak as part of the installation. The clients and their secrets are all generated and configured within this included IDP. If you wish to your own IDP, then clients for the Node Hub Adapter and the Node UI will have to be created and their secrets set in the values template. See the <a href="#using-your-own-idp">Using Your Own IDP</a> section for more information.</p><h3 id="ingress" tabindex="-1">Ingress <a class="header-anchor" href="#ingress" aria-label="Permalink to &quot;Ingress&quot;">​</a></h3><p>To allow domain names to be used for individual services in k8s, the ingress must be enabled and the hostnames set, otherwise the ports for individual services must be port forwarded to access the GUIs e.g.</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> port-forward</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> svc/flame-node-node-ui</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 3000:3000</span></span></code></pre></div><p>The values template file can be used to enable ingress and specify hostname for the services:</p><div class="warning custom-block"><p class="custom-block-title">Check your DNS</p><p>Be sure any domain names you set for these applications are configured in your DNS to point towards your k8s cluster!</p></div><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">global</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  hub</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    auth</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      robotUser</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&lt;Robot ID&gt;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      robotSecret</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&lt;Robot Secret&gt;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  node</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    ingress</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      enabled</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      hostname</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">https://your.node.ui.domain.com</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">keycloak</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  auth</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    adminUser</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">admin</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    adminPassword</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">admin</span></span></code></pre></div><div class="info custom-block"><p class="custom-block-title">Note</p><p>The default installation method assumes that if you have SSL enabled (i.e. using HTTPS), then this is handled by a reverse proxy. If this is not the case, you need to disable the proxy headers for keycloak like shown in this <a href="/files/values_no_reverse_proxy_example.yaml" download>example</a>.</p></div><h3 id="using-your-own-idp" tabindex="-1">Using Your Own IDP <a class="header-anchor" href="#using-your-own-idp" aria-label="Permalink to &quot;Using Your Own IDP&quot;">​</a></h3><p>For better security, this software uses Keycloak for authenticating the various services and users that make up FLAME. Keycloak is installed along with the other services and is required for the creation and management of the individual analyses. Using the keycloak console, the admin you can add additional users who can access the FLAME UI, but you may also use your own IDP for authentication if you wish.</p><p>To enable this, first you must create individual clients for both the Node UI and the Hub Adapter in your IDP in either their own realm, or in a realm with the users you wish to grant access to. Be sure to enable client authentication and take note of the client ID and secret for both of these newly created clients as this information as well as the (accessible) URL for your IDP must be provided in the <code>values.yaml</code>. An example of how to configure this in for your cluster can be seen in this <a href="/files/values_separate_idp.yaml" download>separate IDP example</a>.</p><h2 id="installation-1" tabindex="-1">Installation <a class="header-anchor" href="#installation-1" aria-label="Permalink to &quot;Installation&quot;">​</a></h2><p>Once the <code>values.yaml</code> has been fully configured, it can then be used to install the FLAME Node.</p><div class="info custom-block"><p class="custom-block-title">Note</p><p>Currently, one can only install the software by cloning the repository from GitHub. Additional installation methods will be added in the future including a dedicated chart repository.</p></div><h3 id="installing-from-the-cloned-github-repository" tabindex="-1">Installing from the Cloned GitHub Repository <a class="header-anchor" href="#installing-from-the-cloned-github-repository" aria-label="Permalink to &quot;Installing from the Cloned GitHub Repository&quot;">​</a></h3><p>Users can clone the FLAME Node Helm charts by cloning the <code>node-deployment</code> <a href="https://github.com/PrivateAIM/node-deployment" target="_blank" rel="noreferrer">repository</a> from GitHub. The <code>flame/</code> directory contains the parent helm chart used for the deployment.</p><p>First you must compile the sub-charts:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> flame/</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">helm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dependency</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build</span></span></code></pre></div><p>This will package the Helm charts for the individual components and bundle them in a folder in the <code>flame/</code> directory.</p><h3 id="deployment" tabindex="-1">Deployment <a class="header-anchor" href="#deployment" aria-label="Permalink to &quot;Deployment&quot;">​</a></h3><div class="info custom-block"><p class="custom-block-title">Note</p><p>The Helm release name <code>flame-node</code> is used in the following examples, but any release name can be used in place of it.</p></div><p>If you edited the default <code>values.yaml</code>, then you can run the following command from within the <code>flame/</code> directory to install the node:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">helm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> flame-node</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> .</span></span></code></pre></div><p>If you created your own custom values template file (e.g. <code>my-values.yaml</code>) then it can be applied during installation (and upgrades):</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">helm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> my-values.yaml</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> flame-node</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> .</span></span></code></pre></div><div class="warning custom-block"><p class="custom-block-title">Startup Time</p><p>Several services are deployed as part of this Helm chart and some need to execute initialization containers in order to properly import the configuration. This can cause the <code>helm install</code> to hang for a few minutes while everything is deployed and verified, so please have patience during this step and do not prematurely cancel the command.</p></div>`,45),l=[n];function o(h,r,d,p,c,k){return s(),a("div",null,l)}const g=e(t,[["render",o]]);export{m as __pageData,g as default};
